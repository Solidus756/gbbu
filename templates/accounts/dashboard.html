{% extends "base_dashboard.html" %}
{% block title %}Dashboard - Charity Streaming{% endblock %}
{% block content %}
<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <div class="col-md-3">
      <div class="card mb-4">
        <div class="card-header">
          <h5>Menu</h5>
        </div>
        <ul class="list-group list-group-flush">
          <li class="list-group-item">
            <a href="{% url 'accounts:dashboard' %}"><i class="fas fa-user"></i> Mon Profil</a>
          </li>
          <li class="list-group-item">
            <a href="{% url 'notifications:dashboard' %}">
              <i class="fas fa-bell"></i> Notifications 
              {% if notif_count > 0 %}
                <span class="badge bg-danger">{{ notif_count }}</span>
              {% endif %}
            </a>
          </li>
          {% if is_staff %}
          <li class="list-group-item">
            <a href="{% url 'staff:staff_effectif' %}"><i class="fas fa-users"></i> Staff Effectif</a>
          </li>
          <li class="list-group-item">
            <a href="{% url 'staff:candidatures' %}"><i class="fas fa-user-plus"></i> Candidatures</a>
          </li>
          <li class="list-group-item">
            <a href="{% url 'staff:reserve' %}"><i class="fas fa-user-clock"></i> Réserve</a>
          </li>
          <li class="list-group-item">
            <a href="{% url 'staff:postes' %}"><i class="fas fa-briefcase"></i> Postes</a>
          </li>
          {% endif %}
        </ul>
      </div>
    </div>
    <!-- Contenu principal -->
    <div class="col-md-9">
      <div class="card mb-4">
        <div class="card-header">
          <h4>Résumé du profil</h4>
        </div>
        <div class="card-body">
          <p><strong>Nom d'utilisateur :</strong> {{ user.username }}</p>
          {% if is_streamer %}
            <p><strong>Twitch :</strong> {{ user.streamer_profile.twitch_name }}</p>
          {% endif %}
          {% if is_staff and staff_app %}
            <p><strong>Poste demandé :</strong> {{ staff_app.poste_demande.poste }}</p>
            <p><strong>Status :</strong> {{ staff_app.get_status_display }}</p>
          {% endif %}
          <a href="{% url 'accounts:profile_edit' %}" class="btn btn-primary">Éditer mon profil</a>
        </div>
      </div>
      <div class="card mb-4">
        <div class="card-header">
          <h4>Notifications</h4>
        </div>
        <div class="card-body">
          {% if notifications %}
            <ul class="list-group">
              {% for notif in notifications %}
                <li class="list-group-item">
                  <i class="fas fa-bell"></i> {{ notif.title }} - {{ notif.message }}
                  <a href="{% url 'notifications:mark_notification_as_read' notif.id %}" class="btn btn-sm btn-success float-end">Marquer comme lue</a>
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p>Aucune notification non lue.</p>
          {% endif %}
        </div>
      </div>
      {% if is_staff and staff_app %}
      <div class="card mb-4">
        <div class="card-header">
          <h4>Détails Staff</h4>
        </div>
        <div class="card-body">
          <p><strong>Poste demandé :</strong> {{ staff_app.poste_demande.poste }}</p>
          <p><strong>Status :</strong> {{ staff_app.get_status_display }}</p>
          <p><strong>Postes requis :</strong> {{ staff_app.poste_demande.nombre_de_postes }}</p>
          <p><strong>Postes disponibles :</strong> {{ staff_app.postes_disponibles }}</p>
          <p><strong>Nombre de réservistes :</strong> {{ staff_app.nombre_reserve }}</p>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

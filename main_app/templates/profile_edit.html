{% extends 'base.html' %}

{% block content %}

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <h2>Modifier le profil</h2>
    <div>
        {{ form.as_p }}
    </div>

    <h3>Réseaux sociaux</h3>
    <div class="social-accounts">
        {{ social_formset.management_form }}  <!-- ⚠️ Obligatoire pour Django -->

        <table class="table">
            <thead>
                <tr>
                    <th>Réseau</th>
                    <th>Nom d'utilisateur</th>
                    <th>Supprimer</th>
                </tr>
            </thead>
            <tbody>
                {% for form in social_formset %}
                    <tr>
                        <!-- ⚠️ Ajout du préfixe pour que Django reconnaisse les champs -->
                        <td>
                            {{ form.network }}
                            {% for hidden in form.hidden_fields %}
                                {{ hidden }}
                            {% endfor %}
                        </td>
                        <td>{{ form.username }}</td>
                        <td>
                            {% if form.instance.pk %}
                                {{ form.DELETE }}
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <button type="submit" class="btn btn-primary">Enregistrer</button>
</form>

{% endblock %}
